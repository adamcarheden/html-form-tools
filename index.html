<!DOCTYPE html>                                                                                               
<html>
<head>
<meta charset="utf-8">
<title>html-input-tools</title>
<script type='text/javascript' src='html-input-tools.js'></script>

<script>
	window.addEventListener('load', function(event) {
		var minput = new window['html-input-tools'].ManagedInput('money', {
			unformat: function(value, cursorPos) {
				var unf = value.replace(/^\$*/,'')
				var cp = cursorPos
				var ext = value.length - unf.length
				cp -= Math.min(cursorPos, ext)
				return { value: unf, cursorPos: cp }
			},
			validate: function(value) {
				if (value.match(/^\d+(\.\d+)?$/)) return true
				if (value.length === 0 || value.match(/^\d*\.$/)) return false;
				throw new Error("Invalid value '"+value+"'");
			},
			format: function(value, cursorPos) {
				var res = {value: '$'+value, cursorPos: (cursorPos === false) ? false : cursorPos+1 }
				return res
			},
			sync: function(value) {
				console.log({sync: value});
				document.querySelector('#moneyRow .insync').innerHTML = '<span style="color: Green">Yes</span>';
			},
			invalid: function(ov,nv,uf,raw) { 
				console.log({invalid: nv});
				document.querySelector('#moneyRow .valid').innerHTML = '<span style="color: red">Invalid</span>';
				document.querySelector('#moneyRow .insync').innerHTML = 'out of sync';
			}, 
			intermediate: function(ov,nv,uf,raw) { 
				console.log({intermediate: nv});
				document.querySelector('#moneyRow .valid').innerHTML = '<span style="color: blue">Intermediate</span>';
				document.querySelector('#moneyRow .insync').innerHTML = 'out of sync';
			}, 
			valid: function(ov,nv,uf,raw) { 
				console.log({valid: nv});
				document.querySelector('#moneyRow .valid').innerHTML = '<span style="color: green">Valid</span>';
			}, 
		}, {debug: false});
	});
</script>

</head>
<body>
	<h1>HTML Input Tools</h1>
	<table>
	<tr id='intRow'><td>Integer</td><td><input id='int'/></td><td class='valid'></td><td class='insync'></td></tr>
	<tr id='decRow'><td>Decimal</td><td><input id='dec'/></td><td class='valid'></td><td class='insync'></td></tr>
	<tr id='moneyRow'><td>Money  </td><td><input id='money'></td><td class='valid'></td><td class='insync'></td></tr>
	</table>
</body>
</html>

